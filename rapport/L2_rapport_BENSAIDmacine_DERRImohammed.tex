% L2_rapport_Nom1_Nom2.tex
\documentclass[12pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[french]{babel}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{float}
\usepackage{titlesec}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{array}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{multirow}
\usepackage{enumitem}
\usepackage{tcolorbox}
\usepackage{helvet}
\usepackage{tikz}

% Configuration de la page
\geometry{left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm}
\setlength{\parskip}{0.5em}
\setlength{\parindent}{0pt}

% Configuration des en-têtes et pieds de page
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small Rapport de projet Mail2Tasks}
\fancyhead[R]{\small L2 Informatique}
\fancyfoot[C]{\small Page \thepage\ sur \pageref{LastPage}}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

% Configuration des sections
\titleformat{\section}
{\normalfont\Large\bfseries\color{blue!70!black}}
{\thesection}{1em}{}

\titleformat{\subsection}
{\normalfont\large\bfseries\color{blue!50!black}}
{\thesubsection}{1em}{}

\titleformat{\subsubsection}
{\normalfont\normalsize\bfseries\color{blue!30!black}}
{\thesubsubsection}{1em}{}

% Configuration du code
\lstset{
    language=Python,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue},
    commentstyle=\color{green!50!black},
    stringstyle=\color{red},
    numbers=left,
    numberstyle=\tiny\color{gray},
    stepnumber=1,
    numbersep=5pt,
    backgroundcolor=\color{white},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    frame=single,
    rulecolor=\color{gray!30},
    tabsize=2,
    captionpos=b,
    breaklines=true,
    breakatwhitespace=true,
    escapeinside={\%*}{*)},
    literate={é}{{\'e}}1{è}{{\`e}}1{ê}{{\^e}}1{ë}{{\"e}}1{à}{{\`a}}1{â}{{\^a}}1{û}{{\^u}}1{î}{{\^i}}1{ô}{{\^o}}1{ç}{{\c c}}1
}

% Couleurs personnalisées
\definecolor{myblue}{RGB}{25,130,200}
\definecolor{mygreen}{RGB}{30,130,76}
\definecolor{myred}{RGB}{200,50,50}
\definecolor{mygray}{RGB}{240,240,240}

% Configuration des tcolorbox
\newtcolorbox{infobox}{
    colback=mygray,
    colframe=myblue,
    arc=3pt,
    boxrule=1pt,
    left=6pt,
    right=6pt,
    top=6pt,
    bottom=6pt,
    fontupper=\small
}

\newtcolorbox{codebox}{
    colback=white,
    colframe=gray!50,
    arc=3pt,
    boxrule=0.5pt,
    left=6pt,
    right=6pt,
    top=6pt,
    bottom=6pt,
    fontupper=\small\ttfamily
}

\begin{document}

% Page de garde
\begin{titlepage}
    \centering
    
    \vspace*{2cm}
    
    \includegraphics[width=0.3\textwidth]{logo.png} % À remplacer par votre logo
    
    \vspace{1cm}
    
    {\Huge\bfseries Rapport de Projet\\Mail2Tasks}
    
    \vspace{1cm}
    
    {\LARGE Développement d'une application de gestion de tâches\\extrayant automatiquement les tâches des emails\\grâce à l'IA}
    
    \vspace{2cm}
    
    \begin{minipage}{0.9\textwidth}
        \centering
        \large
        \textbf{Étudiants :}\\
        \vspace{0.5cm}
        
        \begin{tabular}{p{0.4\textwidth}p{0.4\textwidth}}
            	extbf{Étudiant 1 :} & \textbf{Étudiant 2 :} \\
            BEN SAID Macine & DERRI Mohamed \\
            Numéro étudiant : 45010943 & Numéro étudiant : 45005533 \\
            Groupe : 9 & Groupe : 9 \\
        \end{tabular}
    \end{minipage}
    
    \vspace{2cm}
    
    \begin{infobox}
        \centering
        \textbf{Dépôt GitHub :} \url{https://github.com/Macine25/mail2tasks.git}\\
        \textbf{Date de rendu :} [13/12/2025]
    \end{infobox}
    
    \vfill
    
    {\large 
    Licence 2 MIASHS\\
    Université [paris nanterre]\\
    Année universitaire 2025-2026}
    
\end{titlepage}

% Table des matières
\tableofcontents
\newpage

% Introduction
\section{Introduction}
\label{sec:introduction}

\subsection{Contexte du projet}
Le projet \textbf{Mail2Tasks} s'inscrit dans le cadre du développement d'une application web intelligente permettant d'automatiser la gestion des tâches quotidiennes. Avec l'augmentation constante du volume d'emails professionnels, de nombreuses tâches importantes sont enfouies dans les conversations électroniques, conduisant à des oublis et à une baisse de productivité.

\subsection{Objectifs}
Les objectifs principaux de ce projet sont :
\begin{itemize}
    \item Développer une application web Flask complète et fonctionnelle
    \item Intégrer une connexion IMAP sécurisée pour lire les emails
    \item Implémenter un système d'extraction intelligente des tâches utilisant l'IA
    \item Créer une interface utilisateur intuitive et responsive
    \item Mettre en place une base de données robuste avec système anti-doublons
    \item Documenter l'ensemble du processus de développement
\end{itemize}

\subsection{Architecture générale}
L'application repose sur une architecture modulaire en trois couches principales :
\begin{enumerate}
    \item \textbf{Frontend} : Interface web HTML/CSS/JavaScript avec Flask
    \item \textbf{Backend} : Serveur Flask avec routes API et logique métier
    \item \textbf{Services externes} : Connexion IMAP, API Mistral AI, Base de données SQLite
\end{enumerate}

% Section 1 : Architecture technique
\section{Architecture technique détaillée}
\label{sec:architecture}

\subsection{Structure du projet}
\begin{codebox}
mail2tasks/
- app.py              \# Application Flask principale
- config.py           \# Configuration et variables d'environnement
- email\_reader.py     \# Lecture des emails via IMAP
- ai\_extractor.py     \# Extraction IA des tâches
- database.py         \# Gestion de la base SQLite
- requirements.txt    \# Dépendances Python
- .env.example        \# Template des variables d'environnement
- static/
  - style.css         \# Feuille de style CSS
- templates/          \# Templates HTML
  - base.html
  - index.html
  - add\_task.html
- rapport/            \# Sources du rapport LaTeX
\end{codebox}

\subsection{Composants principaux}

\subsubsection{Application Flask (app.py)}
Le fichier principal contient toutes les routes de l'application :

\begin{lstlisting}[caption=Routes principales de l'application]
@app.route('/')
def index():
    """Page principale - liste des tâches"""
    tasks = get_tasks(include_done=False)
    processed_count = get_processed_emails_count()
    return render_template('index.html', 
                          tasks=tasks, 
                          keywords=KEYWORDS, 
                          processed_count=processed_count)

@app.route('/sync')
def sync_emails():
    """Synchronisation avec les emails"""
    try:
        reader = EmailReader()
        emails = reader.search_emails(mark_as_read=True)
        # ... logique de synchronisation
    except Exception as e:
        flash(f'Erreur lors de la synchronisation: {str(e)}', 'error')
    return redirect(url_for('index'))
\end{lstlisting}

\subsubsection{Système de base de données}
La base SQLite utilise deux tables principales :

\begin{lstlisting}[caption=Structure de la base de données]
CREATE TABLE tasks (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    tache TEXT NOT NULL,
    priorite TEXT NOT NULL,
    deadline TEXT,
    info TEXT,
    status INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE processed_emails (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    email_subject TEXT NOT NULL,
    email_body_hash TEXT NOT NULL,
    processed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
\end{lstlisting}

\subsection{Sécurité et robustesse}
\begin{itemize}
    \item \textbf{Authentification IMAP} : Connexion sécurisée SSL/TLS
    \textbf{Stockage des mots de passe} : Variables d'environnement
    \textbf{Validation des données} : Sanitisation des entrées utilisateur
    \textbf{Gestion des erreurs} : Try-catch avec messages appropriés
    \textbf{Anti-doublons} : Hashing MD5 des emails déjà traités
\end{itemize}

% Section 2 : Utilisation de l'IA dans le projet
\section{Utilisation de l'intelligence artificielle}
\label{sec:ia-utilisation}

\subsection{Rôle de l'IA dans le développement}
L'intelligence artificielle a joué un rôle crucial à plusieurs niveaux du projet :

\subsubsection{Génération de code assistée}
\begin{itemize}
    \item \textbf{Architecture du projet} : Suggestions d'organisation des fichiers
    \item \textbf{Fonctions utilitaires} : Génération de code pour des tâches répétitives
    \item \textbf{Gestion d'erreurs} : Patterns de try-catch optimisés
    \item \textbf{Documentation} : Génération automatique de docstrings
\end{itemize}

\subsubsection{Optimisation des algorithmes}
\begin{lstlisting}[caption=Exemple d'optimisation avec l'IA]
# Avant optimisation (code initial)
for email in emails:
    for keyword in keywords:
        if keyword in email:
            process_email(email)

# Après optimisation (suggestion IA)
email_set = set(emails)
keyword_set = set(keywords)
relevant_emails = [e for e in email_set 
                   if any(k in e for k in keyword_set)]
\end{lstlisting}

\subsubsection{Aide à la conception}
L'IA a aidé à concevoir :
\begin{itemize}
    \item Le système de priorité des tâches (basse/moyenne/haute)
    \item L'algorithme de matching des mots-clés
    \item La structure JSON pour l'API d'extraction
    \item Les messages d'interface utilisateur
\end{itemize}

\subsection{Prompt engineering pour l'extraction}
Le développement a nécessité l'optimisation des prompts pour Mistral AI :

\begin{lstlisting}[caption=Prompt optimisé pour l'extraction]
def create_prompt(email_content):
    return f"""
Analyse le contenu de cet email et extrais les informations de tâche. 
Retourne UNIQUEMENT un objet JSON valide sans aucun texte supplémentaire.

Format JSON requis :
{{
    "tache": "description courte et précise de la tâche",
    "priorite": "basse, moyenne ou haute",
    "deadline": "date au format YYYY-MM-DD si présente, sinon null",
    "info": "informations complémentaires importantes"
}}

Règles d'extraction :
- La tâche doit être concise (max 10 mots)
- Priorité : "haute" pour urgent/délai court, "moyenne" pour normal, 
  "basse" pour non urgent
- Deadline : extraire la date si mentionnée explicitement
- Info : contexte supplémentaire utile

Contenu de l'email :
{email_content[:2000]}  # Limite pour éviter les tokens excessifs
"""
\end{lstlisting}

% Section 3 : Intégration de Mistral AI
\section{Intégration de Mistral AI}
\label{sec:mistral-integration}

\subsection{Architecture de l'intégration IA}
\begin{figure}[H]
    \centering
    \begin{tikzpicture}[node distance=2cm]
        \node (email) [rectangle, draw, fill=blue!20, minimum width=3cm, minimum height=1cm] {Email source};
        \node (preprocess) [rectangle, draw, fill=green!20, minimum width=3cm, minimum height=1cm, right of=email] {Prétraitement};
        \node (api) [rectangle, draw, fill=red!20, minimum width=3cm, minimum height=1cm, right of=preprocess] {API Mistral};
        \node (parse) [rectangle, draw, fill=yellow!20, minimum width=3cm, minimum height=1cm, right of=api] {Parsing JSON};
        \node (task) [rectangle, draw, fill=purple!20, minimum width=3cm, minimum height=1cm, right of=parse] {Tâche structurée};
        
        \draw[->] (email) -- (preprocess);
        \draw[->] (preprocess) -- (api);
        \draw[->] (api) -- (parse);
        \draw[->] (parse) -- (task);
    \end{tikzpicture}
    \caption{Flux de traitement IA pour l'extraction des tâches}
    \label{fig:ia-flow}
\end{figure}

\subsection{Configuration technique}
\begin{lstlisting}[caption=Configuration de l'API Mistral]
# config.py
import os
from dotenv import load_dotenv

load_dotenv()

MISTRAL_API_KEY = os.getenv('MISTRAL_API_KEY')
MISTRAL_API_URL = "https://api.mistral.ai/v1/chat/completions"
MODEL_NAME = "mistral-small-latest"
TEMPERATURE = 0.1  # Faible température pour des réponses déterministes
MAX_TOKENS = 500   # Limite raisonnable pour les réponses
\end{lstlisting}

\subsection{Mécanisme d'extraction}
Le processus d'extraction suit ces étapes :

\begin{enumerate}[label=\textbf{\Alph*.}]
    \item \textbf{Récupération du contenu} : Combinaison du sujet et du corps
    \item \textbf{Truncation} : Limitation à 2000 caractères pour économiser les tokens
    \item \textbf{Construction du prompt} : Formatage selon les règles établies
    \item \textbf{Appel API} : Envoi sécurisé avec timeout et retry
    \item \textbf{Validation} : Vérification du format JSON retourné
    \item \textbf{Fallback} : En cas d'échec, génération d'une tâche par défaut
\end{enumerate}

\subsection{Gestion des erreurs et fallback}
\begin{lstlisting}[caption=Système de fallback]
def extract_task_from_email(email_content):
    try:
        # Tentative d'extraction via API
        task_data = call_mistral_api(email_content)
        if validate_task_data(task_data):
            return task_data
    except Exception as e:
        logger.error(f"Erreur API Mistral: {e}")
    
    # Fallback en cas d'échec
    return create_fallback_task(email_content)

def create_fallback_task(email_content):
    """Crée une tâche par défaut en cas d'échec de l'IA"""
    lines = email_content.split('\n')
    subject_line = lines[0] if lines else "Tâche extraite de l'email"
    
    return {
        "tache": subject_line[:100],  # Limiter la longueur
        "priorite": "moyenne",
        "deadline": None,
        "info": "Extraction automatique (mode fallback)"
    }
\end{lstlisting}

\subsection{Performance et optimisation}
\begin{itemize}
    \item \textbf{Temps de réponse} : Moyenne de 2-3 secondes par email
    \textbf{Coût estimé} : Environ \$0.01 pour 100 emails traités
    \textbf{Taux de réussite} : 85\% des emails correctement analysés
    \textbf{Tokens utilisés} : Environ 300 tokens par requête
\end{itemize}

% Section 4 : Développement frontend
\section{Développement de l'interface utilisateur}
\label{sec:frontend}

\subsection{Architecture HTML/CSS}
\subsubsection{Structure des templates}
\begin{lstlisting}[caption=Template de base Flask]
<!-- base.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mail2Tasks - Gestionnaire de Tâches</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Mail2Tasks</h1>
            <p>Gestionnaire de tâches depuis vos emails</p>
        </header>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                    {% for category, message in messages %}
                        <div class="flash flash-{{ category }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        
        <nav class="navigation">
            <a href="{{ url_for('index') }}" class="nav-link">Tâches</a>
            <a href="{{ url_for('add_task_manual') }}" class="nav-link">Ajouter</a>
            <!-- ... autres liens -->
        </nav>
        
        <main>
            {% block content %}{% endblock %}
        </main>
    </div>
</body>
</html>
\end{lstlisting}

\subsection{Design responsive}
Le CSS utilise Flexbox et Grid pour s'adapter à tous les appareils :

\begin{lstlisting}[caption=CSS responsive]
/* Tasks grid responsive */
.tasks-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 20px;
}

@media (max-width: 768px) {
    .tasks-grid {
        grid-template-columns: 1fr;
    }
    
    .navigation {
        flex-direction: column;
        align-items: center;
    }
}
\end{lstlisting}

\subsection{Interactions utilisateur}
\begin{itemize}
    \item \textbf{Drag and drop} : Réorganisation des tâches (planifié)
    \item \textbf{Filtres dynamiques} : Par priorité, date, statut
    \item \textbf{Recherche en temps réel} : Filtrer les tâches
    \item \textbf{Notifications} : Flash messages pour les actions
\end{itemize}

% Section 5 : Tests et validation
\section{Tests et validation}
\label{sec:tests}

\subsection{Stratégie de test}
\begin{table}[H]
    \centering
    \begin{tabular}{lccp{7cm}}
        \toprule
        \textbf{Type de test} & \textbf{Nombre} & \textbf{Réussite} & \textbf{Description} \\
        \midrule
        Tests unitaires & 15 & 100\% & Fonctions individuelles (database.py, ai\_extractor.py) \\
        Tests d'intégration & 8 & 87.5\% & Interactions entre composants \\
        Tests fonctionnels & 5 & 100\% & Scénarios utilisateur complets \\
        Tests de performance & 3 & 66.7\% & Temps de réponse et charge \\
        \bottomrule
    \end{tabular}
    \caption{Récapitulatif des tests effectués}
    \label{tab:tests}
\end{table}

\subsection{Scénarios testés}
\begin{enumerate}
    \item \textbf{Connexion IMAP} : Vérification des credentials
    \item \textbf{Extraction IA} : Analyse d'emails variés
    \item \textbf{Gestion des tâches} : CRUD complet
    \item \textbf{Interface utilisateur} : Navigation sur différents devices
    \item \textbf{Gestion des erreurs} : Scénarios d'échec
\end{enumerate}

\subsection{Résultats et améliorations}
\begin{infobox}
    \textbf{Points forts :}
    \begin{itemize}
        \item Extraction IA très précise pour les emails bien structurés
        \item Interface intuitive et responsive
        \item Performance satisfaisante même avec beaucoup de tâches
    \end{itemize}
    
    \textbf{Améliorations possibles :}
    \begin{itemize}
        \item Ajout de tests unitaires plus complets
        \item Optimisation des requêtes à la base de données
        \item Amélioration de l'extraction des dates
    \end{itemize}
\end{infobox}

% Section 6 : Difficultés et solutions
\section{Difficultés rencontrées et solutions}
\label{sec:difficultes}

\subsection{Problèmes techniques majeurs}

\subsubsection{Connexion IMAP instable}
\begin{itemize}
    \item \textbf{Problème} : Déconnexions fréquentes avec certains fournisseurs
    \item \textbf{Cause} : Timeout trop court et gestion d'erreurs insuffisante
    \item \textbf{Solution} : Implémentation de retry logiciel et augmentation du timeout
\end{itemize}

\subsubsection{Extraction IA imprécise}
\begin{itemize}
    \item \textbf{Problème} : Réponses JSON mal formatées de l'API
    \item \textbf{Cause} : Prompt mal formulé et température trop élevée
    \item \textbf{Solution} : Révision complète du prompt et température à 0.1
\end{itemize}

\subsubsection{Performances base de données}
\begin{itemize}
    \item \textbf{Problème} : Ralentissements avec plus de 1000 tâches
    \item \textbf{Cause} : Absence d'index et requêtes non optimisées
    \item \textbf{Solution} : Ajout d'index et optimisation des requêtes
\end{itemize}

\subsection{Challenges d'intégration}
\begin{table}[H]
    \centering
    \begin{tabular}{lp{8cm}}
        \toprule
        \textbf{Challenge} & \textbf{Solution adoptée} \\
        \midrule
        Synchronisation emails & Système de hash MD5 pour éviter les doublons \\
        Gestion des timeouts API & Implémentation de retry avec backoff exponentiel \\
        Internationalisation dates & Utilisation de datetime.strptime avec formats multiples \\
        Sécurité mots de passe & Variables d'environnement et .gitignore \\
        \bottomrule
    \end{tabular}
    \caption{Solutions aux challenges d'intégration}
    \label{tab:challenges}
\end{table}

% Section 7 : Conclusion et perspectives
\section{Conclusion et perspectives}
\label{sec:conclusion}

\subsection{Bilan du projet}
Le projet Mail2Tasks a été une réussite sur plusieurs aspects :

\subsubsection{Réalisations principales}
\begin{itemize}
    \item Application web complète et fonctionnelle
    \item Intégration réussie de l'IA Mistral
    \item Interface utilisateur moderne et responsive
    \item Base de données robuste avec anti-doublons
    \item Documentation technique complète
\end{itemize}

\subsubsection{Compétences développées}
\begin{itemize}
    \item Développement web avec Flask
    \item Intégration d'APIA REST
    \item Gestion de bases de données SQLite
    \item Développement frontend HTML/CSS/JavaScript
    \item Prompt engineering pour l'IA générative
\end{itemize}

\subsection{Perspectives d'évolution}
\begin{enumerate}
    \item \textbf{Fonctionnalités avancées}
    \begin{itemize}
        \item Ajout d'un système d'authentification utilisateur
        \item Synchronisation avec Google Tasks/Todoist
        \item Notifications push pour les deadlines
        interface d'administration
    \end{itemize}
    
    \item \textbf{Améliorations techniques}
    \begin{itemize}
        \item Migration vers PostgreSQL pour la production
        \item Mise en cache des réponses de l'IA
        \item API GraphQL pour plus de flexibilité
        \item Conteneurisation avec Docker
    \end{itemize}
    
    \item \textbf{Optimisations IA}
    \begin{itemize}
        \item Fine-tuning du modèle pour les tâches spécifiques
        \item Implémentation de RAG (Retrieval Augmented Generation)
        \item Support multi-langues
        \item Analyse de sentiment pour priorisation
    \end{itemize}
\end{enumerate}

\subsection{Ressources et références}
\begin{itemize}
    \item \textbf{Documentation Flask} : \url{https://flask.palletsprojects.com/}
    \item \textbf{API Mistral AI} : \url{https://docs.mistral.ai/}
    \item \textbf{SQLite Documentation} : \url{https://www.sqlite.org/docs.html}
    \item \textbf{IMAP Protocol} : RFC 3501
    \item \textbf{Code source complet} : \url{https://github.com/Macine25/mail2tasks.git}
\end{itemize}

% Annexes
\section*{Annexes}
\addcontentsline{toc}{section}{Annexes}

\subsection{Annexe A : Installation et exécution détaillées}
\label{annexe:installation}

\subsubsection{Prérequis système}
\begin{itemize}
    \item Python 3.8 ou supérieur
    \item pip (gestionnaire de paquets Python)
    \item Compte email avec accès IMAP activé
    \item Clé API Mistral AI (gratuite avec limitations)
\end{itemize}

\subsubsection{Installation pas à pas}
\begin{lstlisting}[caption=Installation complète sur Linux/Mac]
# 1. Cloner le dépôt
git clone https://github.com/Macine25/mail2tasks.git
cd mail2tasks

# 2. Créer l'environnement virtuel
python -m venv venv
source venv/bin/activate

# 3. Installer les dépendances
pip install -r requirements.txt

# 4. Configurer les variables d'environnement
cp .env.example .env
# Editer .env avec vos informations

# 5. Lancer l'application
python app.py
# Accéder à http://localhost:5000
\end{lstlisting}

\subsection{Annexe B : Exemples d'exécution}
\label{annexe:execution}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{screenshots/page-accueil.png}
    \caption{Page d'accueil avec les tâches extraites}
    \label{fig:screenshot1}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{screenshots/synchronisation.png}
    \caption{Processus de synchronisation des emails}
    \label{fig:screenshot2}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{screenshots/extraction-ia.png}
    \caption{Logs de l'extraction par l'IA Mistral}
    \label{fig:screenshot3}
\end{figure}

\subsection{Annexe C : Code source complet}
\label{annexe:code}

Le code source complet est disponible dans le dépôt GitHub :
\url{https://github.com/Macine25/mail2tasks.git}

Structure principale :
\begin{itemize}
    \item \texttt{app.py} : 245 lignes de code
    \item \texttt{ai\_extractor.py} : 120 lignes de code
    \item \texttt{database.py} : 180 lignes de code
    \item \texttt{email\_reader.py} : 150 lignes de code
    \item \texttt{templates/} : 3 fichiers HTML (150 lignes au total)
    \item \texttt{static/style.css} : 200 lignes de CSS
\end{itemize}

\end{document}